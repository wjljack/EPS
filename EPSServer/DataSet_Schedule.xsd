<?xml version="1.0" encoding="utf-8"?>
<xs:schema id="DataSet_Schedule" targetNamespace="http://tempuri.org/DataSet_Schedule.xsd" xmlns:mstns="http://tempuri.org/DataSet_Schedule.xsd" xmlns="http://tempuri.org/DataSet_Schedule.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:msprop="urn:schemas-microsoft-com:xml-msprop" attributeFormDefault="qualified" elementFormDefault="qualified">
  <xs:annotation>
    <xs:appinfo source="urn:schemas-microsoft-com:xml-msdatasource">
      <DataSource DefaultConnectionIndex="0" FunctionsComponentName="QueriesTableAdapter" Modifier="AutoLayout, AnsiClass, Class, Public" SchemaSerializationMode="IncludeSchema" xmlns="urn:schemas-microsoft-com:xml-msdatasource">
        <Connections>
          <Connection AppSettingsObjectName="Settings" AppSettingsPropertyName="oaConnectionString" ConnectionStringObject="" IsAppSettingsProperty="true" Modifier="Assembly" Name="oaConnectionString (Settings)" ParameterPrefix="@" PropertyReference="ApplicationSettings.HRSeatServer.Properties.Settings.GlobalReference.Default.oaConnectionString" Provider="System.Data.SqlClient" />
        </Connections>
        <Tables>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="CalendarTaskTableAdapter" GeneratorDataComponentClassName="CalendarTaskTableAdapter" Name="CalendarTask" UserDataComponentName="CalendarTaskTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="oaConnectionString (Settings)" DbObjectName="dwms20111110.dbo.CalendarTask" DbObjectType="Table" GenerateMethods="Get" GenerateShortCommands="true" GeneratorGetMethodName="GetDataForMorning" GetMethodModifier="Public" GetMethodName="GetDataForMorning" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataForMorning" UserSourceName="GetDataForMorning">
                <InsertCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="false">
                    <CommandText>INSERT INTO [CalendarTask] ([UserID], [Task], [StartTime], [EndTime], [LastModifyTime], [Memo]) VALUES (@UserID, @Task, @StartTime, @EndTime, @LastModifyTime, @Memo)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="" DataSourceName="" DbType="Int64" Direction="Input" ParameterName="@UserID" Precision="0" ProviderType="BigInt" Scale="0" Size="0" SourceColumn="UserID" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="" DataSourceName="" DbType="String" Direction="Input" ParameterName="@Task" Precision="0" ProviderType="NVarChar" Scale="0" Size="0" SourceColumn="Task" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="" DataSourceName="" DbType="DateTime" Direction="Input" ParameterName="@StartTime" Precision="0" ProviderType="DateTime" Scale="0" Size="0" SourceColumn="StartTime" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="" DataSourceName="" DbType="DateTime" Direction="Input" ParameterName="@EndTime" Precision="0" ProviderType="DateTime" Scale="0" Size="0" SourceColumn="EndTime" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="" DataSourceName="" DbType="DateTime" Direction="Input" ParameterName="@LastModifyTime" Precision="0" ProviderType="DateTime" Scale="0" Size="0" SourceColumn="LastModifyTime" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="" DataSourceName="" DbType="String" Direction="Input" ParameterName="@Memo" Precision="0" ProviderType="NVarChar" Scale="0" Size="0" SourceColumn="Memo" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </InsertCommand>
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT   ID, UserID, Task, StartTime, EndTime, LastModifyTime, Memo
FROM     CalendarTask
WHERE   CONVERT(varchar(100),[StartTime], 23) = @Date
AND    CONVERT(varchar(100),[StartTime], 24) &lt; '12:00:00'
AND    [UserID] = @UserID</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="Date" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@Date" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="UserID" ColumnName="UserID" DataSourceName="dwms20111110.dbo.CalendarTask" DataTypeServer="bigint" DbType="Int64" Direction="Input" ParameterName="@UserID" Precision="0" ProviderType="BigInt" Scale="0" Size="8" SourceColumn="UserID" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ID" DataSetColumn="ID" />
              <Mapping SourceColumn="UserID" DataSetColumn="UserID" />
              <Mapping SourceColumn="Task" DataSetColumn="Task" />
              <Mapping SourceColumn="StartTime" DataSetColumn="StartTime" />
              <Mapping SourceColumn="EndTime" DataSetColumn="EndTime" />
              <Mapping SourceColumn="LastModifyTime" DataSetColumn="LastModifyTime" />
              <Mapping SourceColumn="Memo" DataSetColumn="Memo" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="oaConnectionString (Settings)" DbObjectName="dwms20111110.dbo.CalendarTask" DbObjectType="Table" GenerateMethods="Get" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByDate" GeneratorSourceName="FillBy1" GetMethodModifier="Public" GetMethodName="GetDataByDate" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByDate" UserSourceName="GetDataByDate">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT EndTime, ID, LastModifyTime, Memo, StartTime, Task, UserID FROM CalendarTask WHERE (CONVERT (varchar(100), StartTime, 23) = @Date) AND (UserID = @UserID)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="Date" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@Date" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="UserID" ColumnName="UserID" DataSourceName="dwms20111110.dbo.CalendarTask" DataTypeServer="bigint" DbType="Int64" Direction="Input" ParameterName="@UserID" Precision="0" ProviderType="BigInt" Scale="0" Size="8" SourceColumn="UserID" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="oaConnectionString (Settings)" DbObjectName="dwms20111110.dbo.CalendarTask" DbObjectType="Table" GenerateMethods="Get" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByRange" GetMethodModifier="Public" GetMethodName="GetDataByRange" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByRange" UserSourceName="GetDataByRange">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT
	[ID],
	[UserID],
	[Task],
	[StartTime],
	[EndTime],
	[LastModifyTime],
	[Memo]
FROM
	[CalendarTask]
WHERE
	[UserID] =@UserID
AND [StartTime] &gt;=@StartTime
AND [EndTime] &lt;=@EndTime
UNION
	SELECT
		*
	FROM
		(
			SELECT
				0 AS ID,
				obu.UserID AS UserID,
				CASE wi.wfStatus
			WHEN 0 THEN
				'出差审批中'
			WHEN 1 THEN
				'出差'
			END AS Task,
			dateadd(HOUR, 8, obi.StartDate) AS StartTime,
			dateadd(HOUR, 18, obi.EndDate) AS EndTime,
			obi.CreateDate AS LastModifyTime,
			u.Name + '的出差事由:' + obi.BusinessDescription AS Memo
		FROM
			onbusinessInfo obi
		INNER JOIN wfinstance wi ON obi.WfInsGuid = wi.wfInsGUID
		AND (
			wi.wfStatus = 0
			OR wi.wfStatus = 1
		)
		AND obi.IsVisible = 1
		INNER JOIN OnBusinessUser obu ON obi.ID = obu.OnbusinessInfoID
		AND obu.UserID =@UserID
		INNER JOIN p_User u ON obu.UserID = u.ID
		) temp
	WHERE
		(
			StartTime &lt;=@StartTime
			AND EndTime &gt;=@StartTime
			OR StartTime &lt;=@EndTime
			AND EndTime &gt;=@EndTime
			OR StartTime &gt;=@StartTime
			AND EndTime &lt;=@EndTime
		)
	UNION
		SELECT
			*
		FROM
			(
				SELECT
					0 AS ID,
					obi.UserID AS UserID,
					CASE wi.wfStatus
				WHEN 0 THEN
					'请假审批中'
				WHEN 1 THEN
					'请假'
				END AS Task,
				CASE isStartMorning
			WHEN 1 THEN
				dateadd(HOUR, 8, obi.StartDate)
			WHEN 0 THEN
				dateadd(HOUR, 13, obi.StartDate)
			END AS StartTime,
			CASE isEndMorning
		WHEN 1 THEN
			dateadd(HOUR, 12, obi.EndDate)
		WHEN 0 THEN
			dateadd(HOUR, 18, obi.EndDate)
		END AS EndTime,
		obi.CreateDate AS LastModifyTime,
		u.Name + '的请假事由:' + obi.Description AS Memo
	FROM
		onleaveInfo obi
	INNER JOIN wfinstance wi ON obi.WfInsGuid = wi.wfInsGUID
	AND (
		wi.wfStatus = 0
		OR wi.wfStatus = 1
	)
	AND obi.UserID =@UserID
	AND obi.IsVisible = 1
	INNER JOIN p_User u ON obi.UserID = u.ID
			) temp
		WHERE
			(
				StartTime &lt;=@StartTime
				AND EndTime &gt;=@StartTime
				OR StartTime &lt;=@EndTime
				AND EndTime &gt;=@EndTime
				OR StartTime &gt;=@StartTime
				AND EndTime &lt;=@EndTime
			)
		ORDER BY
			[StartTime]

</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="UserID" ColumnName="UserID" DataSourceName="dwms20111110.dbo.CalendarTask" DataTypeServer="bigint" DbType="Int64" Direction="Input" ParameterName="@UserID" Precision="0" ProviderType="BigInt" Scale="0" Size="8" SourceColumn="UserID" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="StartTime" ColumnName="StartTime" DataSourceName="dwms20111110.dbo.CalendarTask" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@StartTime" Precision="0" ProviderType="DateTime" Scale="0" Size="8" SourceColumn="StartTime" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="EndTime" ColumnName="EndTime" DataSourceName="dwms20111110.dbo.CalendarTask" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@EndTime" Precision="0" ProviderType="DateTime" Scale="0" Size="8" SourceColumn="EndTime" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="oaConnectionString (Settings)" DbObjectName="dwms20111110.dbo.CalendarTask" DbObjectType="Table" GenerateMethods="Get" GenerateShortCommands="true" GeneratorGetMethodName="GetDataForAfternoon" GeneratorSourceName="FillBy" GetMethodModifier="Public" GetMethodName="GetDataForAfternoon" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataForAfternoon" UserSourceName="GetDataForAfternoon">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT EndTime, ID, LastModifyTime, Memo, StartTime, Task, UserID FROM CalendarTask 
WHERE (CONVERT (varchar(100), EndTime, 23) = @Date) 
AND (CONVERT (varchar(100), EndTime, 24) &gt; '12:00:00') 
AND (UserID = @UserID)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="Date" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="AnsiString" Direction="Input" ParameterName="@Date" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="UserID" ColumnName="UserID" DataSourceName="dwms20111110.dbo.CalendarTask" DataTypeServer="bigint" DbType="Int64" Direction="Input" ParameterName="@UserID" Precision="0" ProviderType="BigInt" Scale="0" Size="8" SourceColumn="UserID" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
        </Tables>
        <Sources />
      </DataSource>
    </xs:appinfo>
  </xs:annotation>
  <xs:element name="DataSet_Schedule" msdata:IsDataSet="true" msdata:UseCurrentLocale="true" msprop:EnableTableAdapterManager="true" msprop:Generator_DataSetName="DataSet_Schedule" msprop:Generator_UserDSName="DataSet_Schedule">
    <xs:complexType>
      <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:element name="CalendarTask" msprop:Generator_TableClassName="CalendarTaskDataTable" msprop:Generator_TableVarName="tableCalendarTask" msprop:Generator_TablePropName="CalendarTask" msprop:Generator_RowDeletingName="CalendarTaskRowDeleting" msprop:Generator_RowChangingName="CalendarTaskRowChanging" msprop:Generator_RowEvHandlerName="CalendarTaskRowChangeEventHandler" msprop:Generator_RowDeletedName="CalendarTaskRowDeleted" msprop:Generator_UserTableName="CalendarTask" msprop:Generator_RowChangedName="CalendarTaskRowChanged" msprop:Generator_RowEvArgName="CalendarTaskRowChangeEvent" msprop:Generator_RowClassName="CalendarTaskRow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ID" msdata:ReadOnly="true" msdata:AutoIncrement="true" msdata:AutoIncrementSeed="-1" msdata:AutoIncrementStep="-1" msprop:Generator_ColumnVarNameInTable="columnID" msprop:Generator_ColumnPropNameInRow="ID" msprop:Generator_ColumnPropNameInTable="IDColumn" msprop:Generator_UserColumnName="ID" type="xs:int" />
              <xs:element name="UserID" msprop:Generator_ColumnVarNameInTable="columnUserID" msprop:Generator_ColumnPropNameInRow="UserID" msprop:Generator_ColumnPropNameInTable="UserIDColumn" msprop:Generator_UserColumnName="UserID" type="xs:long" />
              <xs:element name="Task" msprop:Generator_ColumnVarNameInTable="columnTask" msprop:Generator_ColumnPropNameInRow="Task" msprop:Generator_ColumnPropNameInTable="TaskColumn" msprop:Generator_UserColumnName="Task">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="200" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="StartTime" msprop:Generator_ColumnVarNameInTable="columnStartTime" msprop:Generator_ColumnPropNameInRow="StartTime" msprop:Generator_ColumnPropNameInTable="StartTimeColumn" msprop:Generator_UserColumnName="StartTime" type="xs:dateTime" />
              <xs:element name="EndTime" msprop:Generator_ColumnVarNameInTable="columnEndTime" msprop:Generator_ColumnPropNameInRow="EndTime" msprop:Generator_ColumnPropNameInTable="EndTimeColumn" msprop:Generator_UserColumnName="EndTime" type="xs:dateTime" />
              <xs:element name="LastModifyTime" msprop:Generator_ColumnVarNameInTable="columnLastModifyTime" msprop:Generator_ColumnPropNameInRow="LastModifyTime" msprop:Generator_ColumnPropNameInTable="LastModifyTimeColumn" msprop:Generator_UserColumnName="LastModifyTime" type="xs:dateTime" />
              <xs:element name="Memo" msprop:Generator_ColumnVarNameInTable="columnMemo" msprop:Generator_ColumnPropNameInRow="Memo" msprop:Generator_ColumnPropNameInTable="MemoColumn" msprop:Generator_UserColumnName="Memo" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1000" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:choice>
    </xs:complexType>
  </xs:element>
</xs:schema>